import requests
import pandas

def get_dpe_from_url(url):
    resp = requests.get(url)
    resultat = resp.json()
    return resultat["results"]


url_root = "https://koumoul.com/data-fair/api/v1/datasets/dpe-france/lines"
code_commune = 95500
url_api = f'{url_root}?qs=code_insee_commune_actualise:"{code_commune}"'

dpe = get_dpe_from_url(url_api)
dico = dict()
for e in dpe:
    classe = e["classe_consommation_energie"]
    nbr = dico.get(classe)
    if(nbr is not None):
        dico.update([(classe, nbr+1)])
    else:
        dico.update([(classe, 1)])
print(dico)
